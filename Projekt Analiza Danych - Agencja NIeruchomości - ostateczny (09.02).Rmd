---
title: "Projekt Analiza Danych - Agencja NieruchomoÅ›ci"
author: "Kacper Kulesza, PaweÅ‚ Suszczak"
date: "2024-12-18"
output:
  html_document:
    theme: cerulean
    highlight: tango
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    number_sections: true
    df_print: paged
  pdf_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,      # Ukrywa kod w wynikowym dokumencie
  message = FALSE,   # Ukrywa komunikaty generowane przez pakiety
  warning = FALSE    # Ukrywa ostrzeÅ¼enia
)
options(scipen = 999, digits=3)
library(tidyverse) 
library(xfun)
library(rmdformats)  
library(magrittr)   
library(lubridate)  
library(dplyr)
library(knitr)
library(ggplot2)
library(reshape2)
library(ggstatsplot)
library(rstantools)
library(broom)
#agencja_nieruchomosci <- read_csv("C:/Users/suchy/OneDrive/Pulpit/Pliki studia/5 rok/Analiza Danych/agencja_nieruchomosci.csv") #moja Å›cieÅ¼ka
agencja_nieruchomosci <- read_csv("C:/Users/Kacper/Desktop/agencja_nieruchomosci.csv") #a to moja sciezka

View(agencja_nieruchomosci)
```

## Opis naszego projektu

ZbiÃ³r danych â€Agencja NieruchomoÅ›ciâ€ zawiera informacje o nieruchomoÅ›ciach i ich cechach, takich jak powierzchnia, liczba sypialni i Å‚azienek, liczba piÄ™ter, dostÄ™pnoÅ›Ä‡ parkingu oraz rÃ³Å¼ne udogodnienia, w tym klimatyzacjÄ™ czy piwnicÄ™. Celem analizy jest okreÅ›lenie, ktÃ³re czynniki majÄ… istotny wpÅ‚yw na cenÄ™ nieruchomoÅ›ci oraz w jakim stopniu. W tym celu zostanÄ… przeprowadzone testy statystyczne, w tym analiza wariancji (ANOVA), aby zbadaÄ‡ zaleÅ¼noÅ›ci miÄ™dzy cenÄ… a wybranymi zmiennymi.

## Sprawdzanie danych

```{r echo=FALSE}
library(knitr)
library(kableExtra)


# Tworzenie ramki danych dla brakÃ³w
missing_data <- data.frame(
  Zmienna = names(agencja_nieruchomosci),
  Liczba_BrakÃ³w = colSums(is.na(agencja_nieruchomosci))
)

# Poprawne generowanie tabeli
kbl(missing_data, col.names = c("Zmienna", "Liczba BrakÃ³w"), row.names = FALSE, format = "html") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE)

# Sprawdzenie czy sÄ… duplikaty
duplicates_count <- sum(duplicated(agencja_nieruchomosci))

# Sprawdzenie wartoÅ›ci ujemnych w kolumnach numerycznych
negative_values <- sapply(agencja_nieruchomosci %>% select(where(is.numeric)), function(x) sum(x < 0))

# Sprawdzanie unikalnych wartoÅ›ci dla zmiennych kategorycznych
categorical_cols <- agencja_nieruchomosci %>% select(where(is.character))
unique_values <- sapply(categorical_cols, function(x) length(unique(x)))

# Wykrywanie wartoÅ›ci odstajÄ…cych (metoda 3 odchyleÅ„ standardowych)
numeric_cols <- agencja_nieruchomosci %>% select(where(is.numeric))
outlier_counts <- sapply(numeric_cols, function(x) sum(abs(scale(x)) > 3))

# Tworzenie czytelnej tabeli podsumowujÄ…cej
summary_table <- data.frame(
  "Kolumna" = c(names(negative_values), names(unique_values), names(outlier_counts)),
  "BrakujÄ…ce WartoÅ›ci" = c(rep(0, length(negative_values)), rep(NA, length(unique_values)), rep(0, length(outlier_counts))),
  "WartoÅ›ci Ujemne" = c(negative_values, rep(NA, length(unique_values)), rep(NA, length(outlier_counts))),
  "WartoÅ›ci OdstajÄ…ce" = c(rep(NA, length(negative_values)), rep(NA, length(unique_values)), outlier_counts),
  "Liczba Unikalnych WartoÅ›ci" = c(rep(NA, length(negative_values)), unique_values, rep(NA, length(outlier_counts)))
)

# Dodanie liczby duplikatÃ³w jako oddzielnego wiersza
summary_table <- rbind(data.frame(Kolumna = "Liczba duplikatÃ³w", BrakujÄ…ce.WartoÅ›ci = NA, WartoÅ›ci.Ujemne = NA, 
                                  WartoÅ›ci.OdstajÄ…ce = NA, Liczba.Unikalnych.WartoÅ›ci = duplicates_count), summary_table)

# Formatowanie tabeli do Å‚adnego wyÅ›wietlenia
print("ğŸ“Š Tabela podsumowujÄ…ca brudne dane ğŸ“Š")
print(format(summary_table, justify = "left"), row.names = FALSE)


#Wizualizacja wartoÅ›ci odstajÄ…cych (boxploty)
par(mfrow=c(1,1))
par(mar=c(7, 4, 4, 2) + 0.1)
boxplot(numeric_cols, 
        main="WartoÅ›ci odstajÄ…ce w zmiennych liczbowych", 
        las=1,           
        horizontal=TRUE, 
        col="lightblue", 
        border="darkblue", 
        notch=TRUE) 
par(mar=c(5, 4, 4, 2) + 0.1)



#Wizualizacja rozkÅ‚adu zmiennych liczbowych
numeric_cols %>% gather() %>%
  ggplot(aes(value)) +
  geom_histogram(bins=30, fill="blue", alpha=0.7) +
  facet_wrap(~key, scales="free") +
  labs(title="Histogramy zmiennych liczbowych")

```


Analiza danych potwierdziÅ‚a, Å¼e nasze zbiory sÄ… kompletne i pozbawione brakÃ³w. Dodatkowo dziÄ™ki analizie wiemy, Å¼e zbiÃ³r danych nie posiada duplikatÃ³w, a wszystkei wartoÅ›ci numeryczne sÄ… dodatnie. DziÄ™ki temu moÅ¼liwe jest peÅ‚ne wykorzystanie dostÄ™pnych informacji do przeprowadzenia analizy oraz uzyskania rzetelnych wynikÃ³w. Po wykorzystaniu metody 3 odchyleÅ„ standardowych na sprawdzenie outlierÃ³w dla zmiennych wykazaÅ‚a ona wystÄ™powanie kilku wartoÅ›ci odstajÄ…cych. Jednak sÄ… to wartoÅ›ci gÅ‚Ã³wnie zwiÄ…zane z cenÄ… co moÅ¼e oznaczaÄ‡ luksusowe usposobienie lokali co moÅ¼e przydac siÄ™ do analiz. Po tej weryfikacji moÅ¼na stwierdziÄ‡, Å¼e nie ma potrzeby edycji bazy danych.


```{r echo=FALSE}
IQR_value <- IQR(agencja_nieruchomosci$price)
upper_bound <- quantile(agencja_nieruchomosci$price, 0.75) + 3 * IQR_value
lower_bound <- quantile(agencja_nieruchomosci$price, 0.25) - 3 * IQR_value
boxplot(agencja_nieruchomosci$price, main = "Wykres pudeÅ‚kowy ceny", 
        xlab = "Price", ylab = "WartoÅ›ci", 
        col = "green", border = "black", outline = TRUE, lwd = 1.2,
        range = 3) 
abline(h = upper_bound, col = "red", lty = 2)
abline(h = lower_bound, col = "red", lty = 2)

```

**Interpretacja wykresu**

Gruba linia w Å›rodku pudeÅ‚ka wskazuje medianÄ™, ktÃ³ra wynosi okoÅ‚o 5 500 000. Na wykresie wÄ…s powyÅ¼ej pudeÅ‚ka jest znacznie dÅ‚uÅ¼szy niÅ¼ wÄ…s poniÅ¼ej, co wskazuje na wiÄ™ksze zrÃ³Å¼nicowanie w gÃ³rnym przedziale cen. Taki rozkÅ‚ad moÅ¼e wynikaÄ‡ z obecnoÅ›ci luksusowych nieruchomoÅ›ci, ktÃ³re charakteryzujÄ… siÄ™ znacznie wyÅ¼szymi cenami niÅ¼ wiÄ™kszoÅ›Ä‡ pozostaÅ‚ych nieruchomoÅ›ci. W zestawie danych widoczny jest rÃ³wnieÅ¼ pojedynczy punkt powyÅ¼ej gÃ³rnego wÄ…sa, ktÃ³ry wskazuje na wartoÅ›Ä‡ odstajÄ…cÄ… â€“ wyjÄ…tkowo drogÄ… nieruchomoÅ›Ä‡. WiÄ™kszoÅ›Ä‡ obserwacji znajduje siÄ™ w zakresie od 4 000 000 do 7 000 000, co sugeruje, Å¼e ceny sÄ… wzglÄ™dnie jednorodne w tym przedziale.

**Badanie rozkÅ‚adu cen za metr kwadratowy pod wzglÄ™dem wielkoÅ›ci (metraÅ¼u) nieruchomoÅ›ci**

W tabeli poniÅ¼ej przedstawiono statystyki opisowe ceny za metr kwadratowy w zaleÅ¼noÅ›ci od wielkoÅ›ci nieruchomoÅ›ci. MetraÅ¼ nieruchomoÅ›ci zostaÅ‚ podzielony na 3 grupy- maÅ‚y, Å›redni oraz duÅ¼y. Analiza obejmuje takie miary, jak Å›rednia, mediana i wartoÅ›Ä‡ minimalna.

```{r echo=FALSE}
# Zmiana stÃ³p kwadratowych na metry kwadratowe

agencja_nieruchomosci <- agencja_nieruchomosci %>%
  mutate(area = area*0.092903)

# Cena za metr kwadratowy oraz cena za iloÅ›Ä‡ pokoi

agencja_nieruchomosci$price_per_sqft <- agencja_nieruchomosci$price / agencja_nieruchomosci$area
  agencja_nieruchomosci <- agencja_nieruchomosci %>%
    relocate(price_per_sqft, .after= price)
  
agencja_nieruchomosci$price_per_bedroom <- agencja_nieruchomosci$price / agencja_nieruchomosci$bedrooms 
  agencja_nieruchomosci <- agencja_nieruchomosci %>%
  relocate(price_per_bedroom, .after = price_per_sqft)

# ZaokrÄ…glanie do dwÃ³ch miejsc po przecinku w kolumnie price_per_sqft

agencja_nieruchomosci <- agencja_nieruchomosci %>%
  mutate(area = round(area,2),
    price_per_sqft = round(price_per_sqft,2))

#Ograniczenia zmiennych

agencja_nieruchomosci <- agencja_nieruchomosci %>%
  filter(
    price >= 0,
    bedrooms > 0,
    bathrooms >0
  )

```


```{r echo=FALSE}

# Utworzenie przedziaÅ‚Ã³w metraÅ¼owych
breaks <- quantile(agencja_nieruchomosci$area, probs=seq(0,1, length.out=4), na.rm = TRUE)
labels <- c("MaÅ‚e", "Åšrednie", "DuÅ¼e")
agencja_nieruchomosci$area_group <- cut(agencja_nieruchomosci$area, breaks=breaks, labels=labels, include.lowest = TRUE)
agencja_nieruchomosci <- agencja_nieruchomosci %>%
  relocate(area_group, .after = area)


# Agregacja danych dla ceny za m2
price_per_sqft_stats <- agencja_nieruchomosci %>%
  group_by(area_group) %>%
  summarise(
    Liczba = n(),
    `Cena za m2` = mean(price_per_sqft, na.rm = TRUE),
    `Mediana za m2` = median(price_per_sqft, na.rm = TRUE),
    `Min za m2` = min(price_per_sqft, na.rm = TRUE),
    `Max za m2` = max(price_per_sqft, na.rm = TRUE)
  ) %>%
  ungroup()

cat("\n")

kable(price_per_sqft_stats, format = "html", caption = "Åšrednie ceny za metr kwadratowy w zaleÅ¼noÅ›ci od grup metraÅ¼owych") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "bordered"), # Dodanie ramki
    full_width = FALSE,  # Tabela o staÅ‚ej szerokoÅ›ci
    position = "center"  # WyÅ›rodkowanie tabeli
  )

```

AnalizujÄ…c przedstawionÄ… tabelÄ™, moÅ¼na zauwaÅ¼yÄ‡, Å¼e Å›rednia cena za metr kwadratowy jest najwyÅ¼sza w przypadku maÅ‚ych nieruchomoÅ›ci i zmniejsza siÄ™ wraz ze wzrostem metraÅ¼u - jest to sytuacja powszechna na rynku nieruchomoÅ›ci. Jak ma to czÄ™sto miejsce podczas nabywania produktÃ³w na rynku, im wiÄ™ksze zamÃ³wienie tym mniejsza cena jednostkowa. Dodatkowo, rÃ³Å¼nica miÄ™dzy cenÄ… maksymalnÄ… a minimalnÄ… (zakres cen) jest najwiÄ™ksza w przypadku duÅ¼ych nieruchomoÅ›ci. Sugeruje to wiÄ™ksze zrÃ³Å¼nicowanie w tej kategorii, ktÃ³re moÅ¼e byÄ‡ zwiÄ…zane z rÃ³Å¼nicami w lokalizacji, standardzie wykoÅ„czenia lub dodatkowymi udogodnieniami.

## Analiza korelacji
W poniÅ¼szej analizie przeprowadzono badanie korelacji miÄ™dzy kluczowymi zmiennymi numerycznymi w zestawie danych agencji nieruchomoÅ›ci. Przedstawiona mapa ciepÅ‚a przedstawia wyniki obliczeÅ„ wspÃ³Å‚czynnikÃ³w korelacji Pearsona, ktÃ³re mogÄ… przyjmowaÄ‡ wartoÅ›ci od -1 do 1. 

```{r echo=FALSE}

numeryczne_zmienne <- agencja_nieruchomosci %>% 
  select(price_per_sqft, area, bedrooms, bathrooms, stories, parking)

korelacja <- cor(numeryczne_zmienne, use = "complete.obs")

korelacja_melted <- melt(korelacja)

ggplot(data = korelacja_melted, aes(x=Var1, y=Var2, fill=value)) +
  geom_tile(color = "black", size = 0.5) +
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
                       midpoint = 0, limit = c(-1,1), space = "Lab", 
                       name="Korelacja") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1),plot.title = element_text(hjust = 0.45) ) +
  labs(x='', y='', title='Mapa ciepÅ‚a korelacji miÄ™dzy zmiennymi')

```
Mapa ciepÅ‚a korelacji przedstawia stopieÅ„ powiÄ…zaÅ„ pomiÄ™dzy rÃ³Å¼nymi cechami nieruchomoÅ›ci. WyrÃ³Å¼niajÄ… siÄ™ nastÄ™pujÄ…ce obserwacje:

- **Cena za metr kwadratowy (price_per_sqft)**:

- Wykazuje umiarkowanÄ… ujemnÄ… korelacjÄ™ z powierzchniÄ… (area), co sugeruje, Å¼e wiÄ™ksze nieruchomoÅ›ci sÄ… taÅ„sze w przeliczeniu na metr kwadratowy.
- Ma niewielkÄ… dodatniÄ… korelacjÄ™ z liczbÄ… sypialni (bedrooms), Å‚azienek (bathrooms) i piÄ™ter (stories), co moÅ¼e wskazywaÄ‡, Å¼e te cechy lekko podnoszÄ… cenÄ™ za metr kwadratowy.
- Nie zauwaÅ¼ono istotnej korelacji z liczbÄ… miejsc parkingowych (parking), co oznacza, Å¼e ta cecha nie wpÅ‚ywa znaczÄ…co na cenÄ™.

- **Powierzchnia (area)**:

- Umiarkowana dodatnia korelacja z liczbÄ… miejsc parkingowych (parking) sugeruje, Å¼e wiÄ™ksze nieruchomoÅ›ci czÄ™Å›ciej oferujÄ… wiÄ™cej miejsc postojowych.
- SÅ‚aba dodatnia korelacja z liczbÄ… sypialni (bedrooms) i Å‚azienek (bathrooms) wskazuje, Å¼e wiÄ™ksza powierzchnia wiÄ…Å¼e siÄ™ z wiÄ™kszÄ… liczbÄ… pomieszczeÅ„, choÄ‡ zaleÅ¼noÅ›Ä‡ ta nie jest silna.

- **Sypialnie (bedrooms)**:

- Umiarkowana korelacja z Å‚azienkami (bathrooms) i liczbÄ… piÄ™ter (stories) pokazuje, Å¼e wiÄ™ksza liczba sypialni czÄ™sto oznacza wiÄ™cej Å‚azienek i kondygnacji w nieruchomoÅ›ci.
- SÅ‚aba korelacja z liczbÄ… miejsc parkingowych (parking) wskazuje, Å¼e liczba sypialni nie jest silnie zwiÄ…zana z dostÄ™pnoÅ›ciÄ… parkingu.

- **Åazienki (bathrooms)**:

- MajÄ… umiarkowanÄ… korelacjÄ™ z liczbÄ… piÄ™ter (stories), co sugeruje, Å¼e w domach wielopoziomowych jest zazwyczaj wiÄ™cej Å‚azienek.

- **Liczba piÄ™ter (stories)**:

- SÅ‚abo koreluje z powierzchniÄ… (area) i miejscami parkingowymi (parking), co oznacza, Å¼e te cechy nie sÄ… silnie powiÄ…zane z liczbÄ… kondygnacji.

- **Miejsca parkingowe (parking)**:

- Silniejsza korelacja z powierzchniÄ… (area) niÅ¼ z innymi cechami sugeruje, Å¼e wiÄ™ksze nieruchomoÅ›ci czÄ™Å›ciej oferujÄ… wiÄ™cej miejsc parkingowych.


## Analiza danych

```{r echo = FALSE}

ggplot(agencja_nieruchomosci, aes(x=price_per_sqft, y=after_stat(density))) + 
  geom_histogram(fill= "forestgreen", bins=30, color="black") + 
  geom_density(color="red", linewidth=1) +
  labs(title="Analiza rozkÅ‚adu ceny za mÂ²")

```

***Interpretacja wykresu***


PowyÅ¼szy wykres przedstawia histogram rozkÅ‚adu cen za metr kwadratowy nieruchomoÅ›ci z naÅ‚oÅ¼onÄ… funkcjÄ… gÄ™stoÅ›ci (czerwona linia). RozkÅ‚ad jest prawoskoÅ›ny, co oznacza, Å¼e wiÄ™kszoÅ›Ä‡ cen skupia siÄ™ w niÅ¼szych przedziaÅ‚ach, podczas gdy nieliczne nieruchomoÅ›ci majÄ… znacznie wyÅ¼sze ceny za mÂ². NajwiÄ™cej obserwacji wystÄ™puje w przedziale od 8 000 do 12 000. Czerwona linia funkcji gÄ™stoÅ›ci wskazuje, Å¼e najczÄ™Å›ciej wystÄ™pujÄ…ca cena za metr kwadratowy wynosi okoÅ‚o 10 000. ObecnoÅ›Ä‡ dÅ‚ugiego ogona po prawej stronie sugeruje istnienie luksusowych nieruchomoÅ›ci, ktÃ³rych ceny znaczÄ…co odbiegajÄ… od mediany. 


```{r echo = FALSE}
ggplot(agencja_nieruchomosci, aes(x = price, y = area, color = as.factor(bedrooms))) +
  geom_point() +
  scale_x_log10(labels = scales::comma) +
  scale_y_log10() + 
  theme_classic() +
  labs(
    title = "RozkÅ‚ad ceny nieruchomoÅ›ci na podstawie jej powierzchni oraz liczby pokoi",
    color = "Liczba pokoi"
  )
```


***Interpretacja wykresu***


PowyÅ¼szy wykres przedstawia zaleÅ¼noÅ›Ä‡ miÄ™dzy cenÄ… nieruchomoÅ›ci a jej powierzchniÄ…, z wyrÃ³Å¼nieniem liczby pokoi za pomocÄ… rÃ³Å¼nych kolorÃ³w. WidaÄ‡, Å¼e cena roÅ›nie wraz z powierzchniÄ…. JednoczeÅ›nie zauwaÅ¼alna jest znaczna rÃ³Å¼norodnoÅ›Ä‡ cen dla nieruchomoÅ›ci o podobnej powierzchni, co sugeruje wpÅ‚yw dodatkowych czynnikÃ³w, takich jak lokalizacja, standard wykoÅ„czenia czy liczba pokoi. NieruchomoÅ›ci z wiÄ™kszÄ… liczbÄ… pokoi sÄ… generalnie droÅ¼sze i majÄ… wiÄ™ksze powierzchnie. Mniejsze nieruchomoÅ›ci (1-2 pokoje) wykazujÄ… wiÄ™kszy rozrzut cen, co moÅ¼e na przykÅ‚ad wynikaÄ‡ z ich lokalizacji w bardziej prestiÅ¼owych obszarach.

PoniÅ¼ej rÃ³wnieÅ¼ zjaduje siÄ™ histogram przedstawiajÄ…cy liczba mieszkaÅ„ z podziaÅ‚em na iloÅ›Ä‡ pokoi. ZauwaÅ¼yÄ‡ moÅ¼na, Å¼e dominujÄ… mieszkania 3 pokojowe.

```{r echo = FALSE}
library(ggplot2)

# Tworzenie histogramu liczby mieszkaÅ„ z podziaÅ‚em na iloÅ›Ä‡ pokoi
ggplot(agencja_nieruchomosci, aes(x = as.factor(bedrooms))) +
  geom_bar(fill = "steelblue", color = "black") +
  theme_minimal() +
  labs(
    title = "Liczba mieszkaÅ„ z podziaÅ‚em na iloÅ›Ä‡ pokoi",
    x = "bedroms",
    y = "Liczba mieszkaÅ„"
  )

```
***--------------------------------------------------------------------------------------------------------------***
```{r echo = FALSE}
ggplot(agencja_nieruchomosci, aes(x = as.factor(bathrooms), y = price)) +
  geom_boxplot(fill = "darkgreen", alpha = 0.99) +
  scale_y_continuous(labels = scales::comma) +  # Separator tysiÄ™cy na osi Y
  theme_minimal() +
  labs(
    title = "RozkÅ‚ad cen w zaleÅ¼noÅ›ci od liczby Å‚azienek",
    x = "bathrooms",
    y = "price"
  )
```

***Interpretacja wykresu***

NieruchomoÅ›ci z jednÄ… Å‚azienkÄ… majÄ… najniÅ¼szÄ… medianÄ™ ceny, co wskazuje na ich relatywnie niÅ¼szÄ… wartoÅ›Ä‡ rynkowÄ…. RozkÅ‚ad cen w tej kategorii jest doÅ›Ä‡ zwarty, ale widoczne sÄ… pojedyncze wartoÅ›ci odstajÄ…ce, ktÃ³re mogÄ… byÄ‡ zwiÄ…zane z czynnikami takimi jak lokalizacja czy standard wykoÅ„czenia. NieruchomoÅ›ci z dwiema Å‚azienkami charakteryzujÄ… siÄ™ wyÅ¼szÄ… medianÄ… ceny i szerszym zakresem cen, co sugeruje wiÄ™ksze zrÃ³Å¼nicowanie w tej grupie. W przypadku nieruchomoÅ›ci z trzema Å‚azienkami mediana ceny jest jeszcze wyÅ¼sza, a rozkÅ‚ad cen wskazuje na obecnoÅ›Ä‡ zarÃ³wno standardowych, jak i luksusowych obiektÃ³w. NieruchomoÅ›ci z czterema Å‚azienkami, choÄ‡ mniej liczne, wykazujÄ… najwyÅ¼sze ceny, co wskazuje, Å¼e sÄ… to gÅ‚Ã³wnie luksusowe domy. OgÃ³lnie, wykres pokazuje, Å¼e wraz ze wzrostem liczby Å‚azienek rosnÄ… zarÃ³wno mediana, jak i zakres cen, co odzwierciedla wiÄ™kszÄ… wartoÅ›Ä‡ rynkowÄ… nieruchomoÅ›ci o wiÄ™kszej liczbie Å‚azienek.


```{r echo = FALSE}
ggplot(agencja_nieruchomosci, aes(x = price, y = area, color = furnishingstatus)) + 
  geom_point() + 
  facet_wrap(~ airconditioning) + 
  labs(title = "RozkÅ‚ad cen nieruchomoÅ›ci w zaleÅ¼noÅ›ci od powierzchni",
  subtitle= "Z podziaÅ‚em na dostÄ™pnoÅ›Ä‡ klimatyzacji i rozrÃ³Å¼nieniem na status umeblowania")

```

***Interpretacja wykresu***

NieruchomoÅ›ci wyposaÅ¼one w klimatyzacjÄ™ charakteryzujÄ… siÄ™ wyÅ¼szymi cenami, szczegÃ³lnie w przypadku wiÄ™kszych powierzchni. Status umeblowania rÃ³wnieÅ¼ odgrywa istotnÄ… rolÄ™ â€“ nieruchomoÅ›ci w peÅ‚ni umeblowane sÄ… wyceniane wyÅ¼ej, co widoczne jest po dominacji czerwonych punktÃ³w w wyÅ¼szych przedziaÅ‚ach cenowych. MoÅ¼na rÃ³wnieÅ¼ zauwaÅ¼yÄ‡, Å¼e mieszkania bez klimatyzacji sÄ… rownieÅ¼ duÅ¼o czÄ™Å›ciej nieumeblowane, co widoczne jest poprzez dominacjÄ™ niebieskich punktÃ³w. PodsumowujÄ…, dostÄ™pnoÅ›Ä‡ klimatyzacji oraz status umeblowania majÄ… istotny wpÅ‚yw na wartoÅ›Ä‡ nieruchomoÅ›ci, a ich obecnoÅ›Ä‡ zwiÄ™ksza cenÄ™ i atrakcyjnoÅ›Ä‡ lokali.

```{r echo = FALSE}

# Wykres pudeÅ‚kowy przedstawiajÄ…cy zaleÅ¼noÅ›Ä‡ miÄ™dzy cenÄ… a piÄ™trem
ggplot(agencja_nieruchomosci, aes(x = as.factor(stories), y = price)) +
  geom_boxplot(fill = "darkred", alpha = 0.7) +
  scale_y_continuous(labels = scales::comma) +  
  theme_minimal() +
  labs(
    title = "ZaleÅ¼noÅ›Ä‡ miÄ™dzy cenÄ… a piÄ™trem nieruchomoÅ›ci",
    x = "stories",
    y = "price"
  )
```

***Interpretacja wykresu***

idaÄ‡, Å¼e wraz ze wzrostem liczby piÄ™ter mediana ceny wzrasta, co sugeruje, Å¼e nieruchomoÅ›ci na wyÅ¼szych piÄ™trach sÄ… bardziej wartoÅ›ciowe. Dla nieruchomoÅ›ci jednopiÄ™trowych i dwupiÄ™trowych ceny sÄ… relatywnie niÅ¼sze, a ich rozkÅ‚ad jest bardziej zwarty. W przypadku nieruchomoÅ›ci trzypiÄ™trowych i czteropiÄ™trowych mediana ceny jest wyÅ¼sza, a zakres cen (odlegÅ‚oÅ›Ä‡ miÄ™dzy wÄ…sami) szerszy, co wskazuje na wiÄ™kszÄ… rÃ³Å¼norodnoÅ›Ä‡ w tej grupie. WartoÅ›ci odstajÄ…ce (punkty powyÅ¼ej gÃ³rnych wÄ…sÃ³w) sÄ… widoczne w kaÅ¼dej kategorii, szczegÃ³lnie w grupach z dwoma i trzema piÄ™trami.  



## Wnioskowanie statystyczne

**Pytanie badawcze:** Cena nieruchomoÅ›ci uzaleÅ¼niona od iloÅ›ci Å‚azienek

**Hipoteza zerowa (H0):** Nie ma statystycznie istotnej rÃ³Å¼nicy w cenie nieruchomoÅ›ci w zaleÅ¼nioÅ›ci od liczby Å‚azienek.

**Hipoteza alternatywna (H1)**: Istnieje statystycznie istotna rÃ³Å¼nica w cenie nieruchomoÅ›ci w zaleÅ¼nioÅ›ci od liczby Å‚azienek.


```{r echo=FALSE}
ggbetweenstats(
  data=agencja_nieruchomosci,
  x=bathrooms,
  y=price,
  drop = FALSE
)
```


**Wnioski**

WartoÅ›Ä‡ p-value wynosi okoÅ‚o 0,00, co jest mniejsze niÅ¼ przyjÄ™ty poziom istotnoÅ›ci 0,05. Oznacza to, Å¼e moÅ¼emy odrzuciÄ‡ hipotezÄ™ zerowÄ… na rzecz hipotezy alternatywnej, co sugeruje, Å¼e liczba Å‚azienek ma istotny statystycznie wpÅ‚yw na cenÄ™ nieruchomoÅ›ci.


**Pytanie badawcze:** Cena za metr kwadratowy uzaleÅ¼niona jest od liczby piÄ™ter w domu

**Hipoteza zerowa (H0):** Nie ma statystycznie istotnej rÃ³Å¼nicy w cenie za metr kwadratowy w zaleÅ¼nioÅ›ci od liczby piÄ™ter.

**Hipoteza alternatywna (H1)**: Istnieje statystycznie istotna rÃ³Å¼nica w cenie metr kwadratowy w zaleÅ¼nioÅ›ci od liczby piÄ™ter.

```{r echo=FALSE}
ggbetweenstats(
  data=agencja_nieruchomosci,
  x=stories,
  y=price_per_sqft
)
```

**Wnioski**

WartoÅ›Ä‡ p-value wynosi 0,000, co jest znaczÄ…co niÅ¼sze od standardowego poziomu istotnoÅ›ci 0,05. W zwiÄ…zku z tym moÅ¼emy odrzuciÄ‡ hipotezÄ™ zerowÄ… na rzecz hipotezy alternatywnej, co wskazuje, Å¼e liczba piÄ™ter ma istotny statystycznie wpÅ‚yw na cenÄ™ za metr kwadratowy.

**Pytanie badawcze:** Cena przypadajÄ…ca na jednÄ… sypialnie uzaleÅ¼niona od iloÅ›ci sypialnii

**Hipoteza zerowa (H0):** Nie ma statystycznie istotnej rÃ³Å¼nicy w cenie przypadajÄ…cej na jednÄ… sypialniÄ™ w zaleÅ¼nioÅ›ci od liczby sypialnii.

**Hipoteza alternatywna (H1)**: Istnieje statystycznie istotna rÃ³Å¼nica w cenie przypadajÄ…cej na jednÄ… sypialniÄ™ w zaleÅ¼nioÅ›ci od liczby sypialnii.

```{r echo=FALSE}
ggbetweenstats(
  data=agencja_nieruchomosci,
  x=bedrooms,
  y=price_per_bedroom
)
```

**Wnioski**

WartoÅ›Ä‡ p-value wynosi 0,01, co jest niÅ¼sze od standardowego poziomu istotnoÅ›ci 0,05. Oznacza to, Å¼e moÅ¼emy odrzuciÄ‡ hipotezÄ™ zerowÄ… na rzecz hipotezy alternatywnej, co sugeruje, Å¼e cena przypadajÄ…ca na jednÄ… sypialniÄ™ rÃ³Å¼ni siÄ™ istotnie w zaleÅ¼noÅ›ci od liczby sypialni.

**Pytanie badawcze:** Cena za metr kwadratowy nieruchomoÅ›ci uzaleÅ¼niona od pokoju goÅ›cinnego

**Hipoteza zerowa (H0):** Srednia cena za metr kwadratowy jest niezaleÅ¼na od pokoju goÅ›cinnego

**Hipoteza alternatywna (H1)**: Srednia cena za metr kwadratowy jest zaleÅ¼na od pokoju goÅ›cinnego

```{r echo=FALSE}

anova1 <- aov(price_per_sqft ~ guestroom, data = agencja_nieruchomosci)
anova_summary <- summary(anova1)

tidy_anova <- tidy(anova1)

kable(tidy_anova, caption = "Analiza wariancji dla ceny za metr kwadratowy w zaleÅ¼noÅ›ci od gpokoju goÅ›cinnego", format = "html", digits = 2)

```

**Wnioski**

Test ANOVA wykazaÅ‚ wartoÅ›Ä‡ p-value rÃ³wnÄ… 0,06, co nieznacznie przekracza standardowy poziom istotnoÅ›ci 0,05. W zwiÄ…zku z tym nie mamy wystarczajÄ…cych podstaw do odrzucenia hipotezy zerowej na rzecz hipotezy alternatywnej, co sugeruje, Å¼e obecnoÅ›Ä‡ pokoju goÅ›cinnego nie ma istotnego wpÅ‚ywu na cenÄ™ za metr kwadratowy.


**Pytanie badawcze:** Liczba miejsc parkingowych dostÄ™pnych w budynku uzaleÅ¼niony od wielkoÅ›ci nieruchomoÅ›ci

**Hipoteza zerowa (H0):** Nie ma statystycznie istotnej rÃ³Å¼nicy w liczbie miejsc parkingowych dostÄ™pnych w budynku w zaleÅ¼nioÅ›ci od wielkoÅ›ci nieruchomoÅ›ci.

**Hipoteza alternatywna (H1)**: Istnieje statystycznie istotna rÃ³Å¼nica w liczbie miejsc parkingowych dostÄ™pnych w budynku

```{r echo=FALSE}
anova2 <- aov(parking ~ area_group, data = agencja_nieruchomosci)

tidy_anova2 <- tidy(anova2)


kable(tidy_anova2, caption = "Analiza wariancji dla liczby miejsc parkingowych w zaleÅ¼noÅ›ci od wielkoÅ›ci nieruchomoÅ›ci", format = "html", digits = 3)

```

**Wnioski**

Test ANOVA wykazaÅ‚ wartoÅ›Ä‡ p-value na poziomie okoÅ‚o 0,000, co jest znacznie niÅ¼sze od standardowego poziomu istotnoÅ›ci 0,05. Oznacza to, Å¼e moÅ¼emy odrzuciÄ‡ hipotezÄ™ zerowÄ… na rzecz hipotezy alternatywnej, co wskazuje, Å¼e liczba dostÄ™pnych miejsc parkingowych w budynku ma istotny statystycznie wpÅ‚yw na wielkoÅ›Ä‡ nieruchomoÅ›ci.


**Pytanie badawcze:** Cena nieruchomoÅ›ci jest uzaleÅ¼niona od statusu umeblowania nieruchomoÅ›ci

**Hipoteza zerowa (H0):** Nie ma statystycznie istotnej rÃ³Å¼nicy w cenie w zaleÅ¼noÅ›ci od statusu umeblowania nieruchomoÅ›ci

**Hipoteza alternatywna (H1)**: Istnieje statystycznie istotna rÃ³Å¼nica w cenie w zaleÅ¼noÅ›ci od statusu umeblowania nieruchomoÅ›ci
j
```{r echo = FALSE}
ggbetweenstats(data=agencja_nieruchomosci, x= furnishingstatus, y=price)
```

**Wnioski**

OÅ› X przedstawia kategorie zwiÄ…zane ze statusem umeblowania, natomiast oÅ› Y odpowiada cenie nieruchomoÅ›ci. WartoÅ›Ä‡ p mniejsza niÅ¼ 0,05 wskazuje na istotne statystycznie rÃ³Å¼nice miÄ™dzy kategoriami. W przypadku tego wykresu wszystkie porÃ³wnane pary kategorii wykazujÄ… wartoÅ›ci p znacznie poniÅ¼ej 0,05, co oznacza, Å¼e istniejÄ… istotne rÃ³Å¼nice miÄ™dzy trzema kategoriami. W rezultacie odrzucamy hipotezÄ™ zerowÄ… i moÅ¼emy stwierdziÄ‡, Å¼e cena nieruchomoÅ›ci zaleÅ¼y od jej statusu umeblowania.


**Pytanie badawcze:** Cena za m2 uzaleÅ¼niona jest od tego czy nieruchomoÅ›Ä‡ znajduje siÄ™ w preferowanej lokalizacji

**Hipoteza zerowa (H0):** Nie ma statystycznie istotnej rÃ³Å¼nicy w cenie za m2 w zaleÅ¼noÅ›ci od tego czy nieruchomoÅ›Ä‡ znajduje siÄ™ w preferowanej lokalizacji

**Hipoteza alternatywna (H1)**: Istnieje statystycznie istotna rÃ³Å¼nica w cenie m2 w zaleÅ¼noÅ›ci od tego czy  nieruchomoÅ›Ä‡ znajduje siÄ™ w preferowanej lokalizacji

```{r echo = FALSE}
ggbetweenstats(data=agencja_nieruchomosci, x= prefarea, y=price_per_sqft)
```

**Wnioski**

OÅ› X przedstawia informacjÄ™, czy nieruchomoÅ›Ä‡ znajduje siÄ™ w preferowanej okolicy (tak lub nie), podczas gdy oÅ› Y obrazuje cenÄ™ za metr kwadratowy. NieruchomoÅ›ci zlokalizowane w preferowanych obszarach wykazujÄ… wyraÅºnie wyÅ¼sze ceny. RÃ³Å¼nice w rozkÅ‚adzie cen miÄ™dzy obiema grupami sÄ… zauwaÅ¼alne. WartoÅ›Ä‡ p-value wynoszÄ…ca 0,01 wskazuje na istotnÄ… zaleÅ¼noÅ›Ä‡ miÄ™dzy cenÄ… za mÂ² a preferowanÄ… lokalizacjÄ… nieruchomoÅ›ci.


**Pytanie badawcze:** Liczba sypialni jest uzaleÅ¼nionaod od liczby piÄ™ter

**Hipoteza zerowa (H0):** Nie ma statystycznie istotnej rÃ³Å¼nicy w liczbie sypialni w zaleÅ¼noÅ›ci od liczby piÄ™ter

**Hipoteza alternatywna (H1)**: Istnieje statystycznie istotna rÃ³Å¼nica w liczbie sypialni w zaleÅ¼noÅ›ci od liczby piÄ™ter

```{r echo = FALSE}
ggbarstats(data=agencja_nieruchomosci, x=stories, y=bedrooms)
```

**Wnioski**

OÅ› pozioma reprezentuje liczbÄ™ sypialni w nieruchomoÅ›ci, natomiast oÅ› pionowa przedstawia procentowÄ… czÄ™stotliwoÅ›Ä‡ poszczegÃ³lnych kategorii liczby piÄ™ter w kaÅ¼dej grupie. W wiÄ™kszoÅ›ci przypadkÃ³w wartoÅ›Ä‡ p-value jest niÅ¼sza niÅ¼ 0,05, wskazujÄ…c na istotnoÅ›Ä‡ statystycznÄ… zaleÅ¼noÅ›ci. Jedynie w skrajnych grupach p-value wynosi 0,11. OgÃ³lnie rzecz biorÄ…c, moÅ¼na stwierdziÄ‡, Å¼e liczba piÄ™ter w nieruchomoÅ›ci wpÅ‚ywa na liczbÄ™ sypialni.


**Pytanie badawcze:** Liczba sypialni jest uzaleÅ¼niona od liczby Å‚azienek 

**Hipoteza zerowa (H0):** Nie ma statystycznie istotnej rÃ³Å¼nicy w liczbie sypialni w zaleÅ¼noÅ›ci od liczby Å‚azienek

**Hipoteza alternatywna (H1)**: Istnieje statystycznie istotna rÃ³Å¼nica w liczbie sypialni w zaleÅ¼noÅ›ci od liczby Å‚azienek


```{r echo = FALSE}
ggpiestats(data=agencja_nieruchomosci, x=bathrooms, y=bedrooms)
```

**Wnioski**

Na ostatnim wykresie mamy seriÄ™ wykresÃ³w koÅ‚owych, ktÃ³re przedstawiajÄ… rozkÅ‚ad liczby sypialni w nieruchomoÅ›ciach, podzielony wedÅ‚ug liczby Å‚azienek. KaÅ¼dy wykres koÅ‚owy odpowiada nieruchomoÅ›ciom z okreÅ›lonÄ… liczbÄ… sypialni i pokazuje procentowy rozkÅ‚ad liczby Å‚azienek w tych nieruchomoÅ›ciach. W tym przypadku aÅ¼ poÅ‚owa grup ma wartoÅ›ci p - value wiÄ™ksze niÅ¼ 0,05. Co oznacza, Å¼e w przypadku grupy 1 , 5 i 6 nie mamy podstaw do odrzucenia hipotezy zerowej i nie ma statystycznie istotnej rÃ³Å¼nicy w liczbie sypialni w zaleÅ¼noÅ›ci od liczby Å‚azienek.


## Podsumowanie

Analiza danych dotyczÄ…cych nieruchomoÅ›ci pozwoliÅ‚a okreÅ›liÄ‡, ktÃ³re czynniki majÄ… istotny wpÅ‚yw na cenÄ™ za metr kwadratowy. Wyniki testÃ³w statystycznych, w tym analizy wariancji (ANOVA), wykazaÅ‚y, Å¼e niektÃ³re zmienne, takie jak liczba sypialni, Å‚azienek czy lokalizacja, mogÄ… znaczÄ…co rÃ³Å¼nicowaÄ‡ ceny. W przypadkach, gdzie wartoÅ›Ä‡ p byÅ‚a niÅ¼sza niÅ¼ 0,05, odrzucono hipotezÄ™ zerowÄ…, co sugeruje istnienie istotnych zaleÅ¼noÅ›ci. Natomiast w sytuacjach, gdzie p-value przekroczyÅ‚o ten poziom, nie znaleziono wystarczajÄ…cych dowodÃ³w na wpÅ‚yw danej cechy na cenÄ™ nieruchomoÅ›ci. Ostateczne wnioski wskazujÄ…, Å¼e wybrane parametry nieruchomoÅ›ci mogÄ… istotnie ksztaÅ‚towaÄ‡ jej wartoÅ›Ä‡ rynkowÄ…, co moÅ¼e mieÄ‡ praktyczne zastosowanie w prognozowaniu cen i podejmowaniu decyzji inwestycyjnych.


















